import { Button, Grid, ListItem, List, ListItemText, Slider , makeStyles, useStyles, Typography, FormControlLabel, Checkbox, Select, TextField, MenuItem, } from '@material-ui/core'
import React from 'react'
import { connect }from 'react-redux'
import store from '../../../store'
import { HackbarCheckbox, HackbarSlider } from '../../hackbar_style/hackbar_style.js'
import PickupFilter from '../pickup_filter'
import { ACTIONS } from '../../../utils/enums.js'

class Pickup extends React.Component{
    constructor(props){
        super(props)
        this.onPickupFilterChange = this.onChangeItemFilterName.bind(this)
    }
    onPickupSpeedChange = (event, new_pickup_speed) => {
        let _module = {
            PickupSpeed: new_pickup_speed,
        }
        store.dispatch({type: ACTIONS.UPDATE_ONE_HACK_MODULE, client: this.props.socket, payload: { module_dict:_module, module_name: 'Settings'}, index:store.getState().receivePacketsReducer.selected_client_id})
           
    }
    onPickupRangeChange = (event, new_pickup_range) => {
        let _module = {
            PickupRange: new_pickup_range*10,
        }
        store.dispatch({type: ACTIONS.UPDATE_ONE_HACK_MODULE, client: this.props.socket, payload: { module_dict:_module, module_name: 'Settings'}, index:store.getState().receivePacketsReducer.selected_client_id})
           
    }
    SwitchAvoidPlayersInPickup = () => {
        let _module = {
            AvoidPlayersInPickup: !this.props.settings.AvoidPlayersInPickup,
        }
        store.dispatch({type: ACTIONS.UPDATE_ONE_HACK_MODULE, client: this.props.socket, payload: { module_dict:_module, module_name: 'Settings'}, index:store.getState().receivePacketsReducer.selected_client_id})
    }
    SwitchPickup = () => {
        let _module = {
            Pickup: !this.props.settings.Pickup,
        }
        store.dispatch({type: ACTIONS.UPDATE_ONE_HACK_MODULE, client: this.props.socket, payload: { module_dict:_module, module_name: 'Settings'}, index:store.getState().receivePacketsReducer.selected_client_id})
    }
    SwitchExcludeInFilter = () => {
        let _module = {
            ExcludeInFilter: !this.props.settings.ExcludeInFilter,
        }
        store.dispatch({type: ACTIONS.UPDATE_ONE_HACK_MODULE, client: this.props.socket, payload: { module_dict:_module, module_name: 'Settings'}, index:store.getState().receivePacketsReducer.selected_client_id})
    }
    SwitchUseRangePickup = () => {
        let _module = {
            UseRangePickup: !this.props.settings.UseRangePickup,
        }
        store.dispatch({type: ACTIONS.UPDATE_ONE_HACK_MODULE, client: this.props.socket, payload: { module_dict:_module, module_name: 'Settings'}, index:store.getState().receivePacketsReducer.selected_client_id})
    }
    SwitchPickupItemFirst = () => {
        let _module = {
            PickupItemFirst: !this.props.settings.PickupItemFirst,
        }
        store.dispatch({type: ACTIONS.UPDATE_ONE_HACK_MODULE, client: this.props.socket, payload: { module_dict:_module, module_name: 'Settings'}, index:store.getState().receivePacketsReducer.selected_client_id})
    }
    SwitchPickupIgnorePath = () => {
        let _module = {
            PickupIgnorePath: !this.props.settings.PickupIgnorePath,
        }
        store.dispatch({type: ACTIONS.UPDATE_ONE_HACK_MODULE, client: this.props.socket, payload: { module_dict:_module, module_name: 'Settings'}, index:store.getState().receivePacketsReducer.selected_client_id})
    }  

    onChangeItemFilterName = (new_value) => {
        console.log(new_value)
        let filtered_list = {}
        for (const [key, value] of Object.entries(this.props.item_list)) {
            if(value.name.includes(new_value)){
                filtered_list[key] = value
            }
          }
        this.setState({
            items_to_show: filtered_list,
            item_filter: new_value,
        })
    }

    render = () => {
        let pickup_range_slider = () => {}
        if (this.props.settings.UseRangePickup){
            pickup_range_slider = () => {
                let label_reco = this.props.language.label_recommended
                let label_high = this.props.language.label_high
                return(
                    <Grid item xs={12} className='item_slider'>
                    <Typography id="discrete-slider-small-steps" gutterBottom>
                        {this.props.language.pickup_range}
                    </Typography>
                    <HackbarSlider
                    onChange={this.onPickupRangeChange}
                            defaultValue={Math.round(this.props.settings.PickupRange/10)}
                            aria-labelledby="discrete-slider-small-steps"
                            step={10}
                            marks={[{value: 300, label:label_reco},{value: 500, label:label_high}]}
                            min={100}
                            max={800}
                            valueLabelDisplay="auto"
                        />
                </Grid>
                )
            }
        }
        return (
        <Grid container>
                <Grid item xs={12}>
                    <FormControlLabel control={<HackbarCheckbox checked={this.props.settings.Pickup} onChange={ () => this.SwitchPickup()} name="mine"/>} label={this.props.language.label_enable_pickup}/>
                </Grid>
                <Grid item xs={6}>
                    <FormControlLabel control={<HackbarCheckbox checked={this.props.settings.ExcludeInFilter} onChange={ () => this.SwitchExcludeInFilter()} name="mine"/>} label={this.props.language.label_exclude_filter}/>
                </Grid>
                <Grid item xs={6}>
                    <FormControlLabel control={<HackbarCheckbox checked={this.props.settings.AvoidPlayersInPickup} onChange={ () => this.SwitchAvoidPlayersInPickup()} name="mine"/>} label={this.props.language.label_dont_pickup_if_player_is_near}/>
                </Grid>
                <Grid item xs={6}>
                    <FormControlLabel control={<HackbarCheckbox checked={this.props.settings.PickupIgnorePath} onChange={ () => this.SwitchPickupIgnorePath()} name="mine"/>} label={this.props.language.label_ignore_path}/>
                </Grid>
                <Grid item xs={6}>
                    <FormControlLabel control={<HackbarCheckbox checked={this.props.settings.PickupItemFirst} onChange={ () => this.SwitchPickupItemFirst()} name="mine"/>} label={this.props.language.label_pick_item_first}/>
                </Grid>
                <Grid item xs={12}>
                    <FormControlLabel control={<HackbarCheckbox checked={this.props.settings.UseRangePickup} onChange={ () => this.SwitchUseRangePickup()} name="mine"/>} label={this.props.language.label_use_range_pickup}/>
                    {pickup_range_slider()}
                </Grid>


                <PickupFilter socket={this.props.socket} pickup_filter={this.props.pickup_filter} item_list={this.props.item_list} language={this.props.pickup_filter_lanuguage}
                              file_handler_language={this.props.file_handler_language} icon_names={this.props.icon_names}/>

        
        </Grid>
        )
    }
}

/* 
                <Grid>
                    <Grid item xs={12} className='item_slider'>
                        <Typography id="discrete-slider-small-steps" gutterBottom>
                            Pickup speed
                        </Typography>
                        <HackbarSlider
                        onChange={this.onPickupSpeedChange}
                                defaultValue={Math.round(this.props.settings.PickupSpeed)}
                                aria-labelledby="discrete-slider-small-steps"
                                step={0.2}
                                marks={[{value: 1, label:'Recomm.'}]}                                                     
                                min={1}
                                max={3}
                                valueLabelDisplay="auto"
                            />
                    </Grid>
                </Grid>
*/

export default Pickup

